<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <title>Document List</title>
  <link rel="stylesheet" th:href="@{/css/style.css}">
  <style>
    table {
        width: 100%;
        border-collapse: collapse;
    }
    table, th, td {
        border: 1px solid #ddd;
    }
    th, td {
        padding: 10px;
        text-align: left;
    }
    th {
        background-color: #f4f4f4;
    }
    a.button {
        padding: 6px 12px;
        background-color: #007bff;
        color: white;
        text-decoration: none;
        border-radius: 4px;
        font-size: 14px;
    }
    a.button:hover {
        background-color: #0056b3;
    }
  </style>
</head>
<body>

<h2>Uploaded Documents</h2>

<table>
  <thead>
  <tr>
    <th>Title</th>
    <th>Subtitle</th>
    <th>Actions</th>
  </tr>
  </thead>
  <tbody id="document-table-body">
  <!-- Filled dynamically with JS -->
  </tbody>
</table>

<script>
  async function loadDocuments() {
      try {
          const response = await fetch('/api/documents/list');
          const data = await response.json();

          const tableBody = document.getElementById('document-table-body');
          tableBody.innerHTML = '';

          data.forEach(doc => {
              const row = document.createElement('tr');

              // Title
              const titleCell = document.createElement('td');
              titleCell.textContent = doc.title;
              row.appendChild(titleCell);

              // Subtitle
              const subtitleCell = document.createElement('td');
              subtitleCell.textContent = doc.subtitle;
              row.appendChild(subtitleCell);

              // Actions
              const actionsCell = document.createElement('td');

              const viewBtn = document.createElement('a');
              viewBtn.textContent = 'View';
              viewBtn.href = doc.fileUrl;  // fileUrl should be full PDF link
              viewBtn.target = '_blank';
              viewBtn.classList.add('button');
              actionsCell.appendChild(viewBtn);

              const downloadBtn = document.createElement('a');
              downloadBtn.textContent = 'Download';
              downloadBtn.href = doc.fileUrl;
              downloadBtn.download = '';
              downloadBtn.classList.add('button');
              downloadBtn.style.marginLeft = '8px';
              actionsCell.appendChild(downloadBtn);

              row.appendChild(actionsCell);

              tableBody.appendChild(row);
          });
      } catch (err) {
          console.error('Error loading documents:', err);
      }
  }

  loadDocuments();
</script>

</body>
</html>
